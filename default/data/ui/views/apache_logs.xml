<dashboard>
  <label>Apache Logs</label>
  <row>
    <panel>
      <title>Top Requests</title>
      <table>
        <title>Requested resources by request count.</title>
        <search>
          <query>sourcetype=honeynet_5_apache* | join uri [search sourcetype=honeynet_5_apache uri=* | stats count(uri) by uri] | stats dc(uri) by uri, count(uri) | rename uri as URI | rename count(uri) as Requests | table URI,  Requests | sort -Requests</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
    <panel>
      <title>Unusual HTTP Verbs</title>
      <table>
        <title>Method is not GET or POST</title>
        <search>
          <query>sourcetype=honeynet_5_apache* NOT method=POST NOT method=GET method=* | rename uri as URI, method as Method, clientip as Client, useragent as "User Agent" | table URI, Method, Client, "User Agent"</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Unsuccessful Requests</title>
      <table>
        <title>Status code is not success (200). HTTP status codes - 3XX: Redirect, 4XX: Client Error, 5XX: Server Error</title>
        <search>
          <query>sourcetype=honeynet_5_apache* NOT status=200 | rename uri as URI, status as Status, method as Method, clientip as Client, useragent as "User Agent" | table URI, Status, Method, Client, "User Agent"</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</dashboard>